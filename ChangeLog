2005-10-06  Christian Persch  <chpe@cvs.gnome.org>

	* lib/widgets/ephy-location-entry.c:
	(ephy_location_entry_style_set), (ephy_location_entry_class_init),
	(ephy_location_entry_set_favicon),
	(ephy_location_entry_set_secure):
	* lib/widgets/ephy-location-entry.h:

	Add style properties for 'secure-[bg|fg]-color', and apply them when
	the entry is in 'secure' mode. Reset the IM context before emitting
	the 'activate' signal.

	* src/ephy-location-action.c: (sync_secure), (connect_proxy),
	(ephy_location_action_set_property),
	(ephy_location_action_get_property),
	(ephy_location_action_class_init):
	* src/ephy-toolbar.c: (ephy_toolbar_set_security_state),
	(ephy_toolbar_init):
	* src/ephy-toolbar.h:
	* src/ephy-window.c: (sync_chromes_visibility),
	(sync_tab_security):

	Set the location entry's 'secure' property on secure sites,
	and also always show the lock for secure sites.

2005-10-06  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/Makefile.am:
	* embed/mozilla/mozilla-embed-single.cpp:

	Add out private plugin directory to MOZ_PLUGIN_PATH too.

2005-10-06  Christian Persch  <chpe@cvs.gnome.org>

	* Makefile.am:
	* configure.ac:
	* plugins/.cvsignore:
	* plugins/Makefile.am:
	* plugins/desktop-file/.cvsignore:
	* plugins/desktop-file/Makefile.am:
	* plugins/desktop-file/plugin.cpp:
	* po/POTFILES.in:

	Add "desktop-file" plugin, adapted from the
	"mozilla-desktop-file-plugin" written by Jorn Baayen <jbaayen@gnome.org>.
	For now only handle .desktop files from file:/// URIs, for security 
	reasons.

2005-10-03  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-state.c: (paned_sync_position_cb),
	(ephy_state_add_paned):

	Use "position" property notification instead of
	size-allocate to monitor the paned's position.

	* src/bookmarks/ephy-bookmarks-editor.c:
	(ephy_bookmarks_editor_construct):

	Use resize=FALSE with gtk_paned_pack1. Fixes growing size of
	the left pane of the bookmarks editor by repeated opening.

2005-10-03  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (setup_ui_manager), (ephy_window_dispose),
	(ephy_window_finalize):

	Fix memory leak.

2005-10-03  Christian Persch  <chpe@cvs.gnome.org>

	* embed/ephy-embed-shell.c: (ephy_embed_shell_dispose):
	* src/ephy-shell.c: (ephy_shell_dispose):

	Make sure we don't unref NULL objects.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* src/bookmarks/ephy-bookmarks.c: (save_filter),
	(ephy_bookmarks_save), (update_bookmark_keywords),
	(bookmark_is_categorized), (ephy_bookmarks_init),
	(ephy_bookmarks_finalize), (ephy_bookmarks_get_topic_uri),
	(ephy_bookmarks_find_keyword):
	* src/epiphany.defs:

	Add configure switch to disable zeroconf bookmarks, since
	they're almost useless since just about nobody ships gnome-vfs
	with howl support enabled, and have also been reported to
	cause long delays on startup.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-tab.c: (ephy_tab_finalize):
	* src/ephy-window.c: (ephy_window_finalize):

	Schedule a GC in finalize of EphyTab and EphyWindow, to 
	work around bug #317242.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/ephy-embed-shell.c: (ephy_embed_shell_dispose),
	(ephy_embed_shell_finalize), (ephy_embed_shell_class_init):
	* embed/ephy-embed.c: (ephy_embed_base_init),
	(ephy_embed_show_page_certificate), (ephy_embed_close):
	* embed/ephy-embed.h:
	* embed/mozilla/EphyBrowser.cpp:
	* embed/mozilla/EphyBrowser.h:
	* embed/mozilla/mozilla-embed.cpp:
	* src/ephy-notebook.c: (ephy_notebook_class_init),
	(close_button_clicked_cb):
	* src/ephy-notebook.h:
	* src/ephy-python.c: (ephy_python_init), (ephy_python_shutdown),
	(ephy_python_schedule_gc):
	* src/ephy-shell.c: (ephy_shell_class_init), (gnome_session_init),
	(ephy_shell_dispose), (ephy_shell_finalize):
	* src/ephy-tab.c: (ephy_tab_init):
	* src/ephy-window.c: (construct_confirm_close_dialog),
	(confirm_close_with_modified_forms), (embed_modal_alert_cb),
	(idle_tab_remove_cb), (schedule_tab_close),
	(embed_close_request_cb), (embed_destroy_browser_cb),
	(tab_added_cb), (tab_removed_cb), (tab_close_request_cb),
	(setup_notebook), (remove_true), (ephy_window_dispose),
	(cancel_handler), (ephy_window_init), (ephy_window_finalize):
	* src/window-commands.c: (event_with_shift),
	(window_cmd_view_reload), (window_cmd_file_close_window):

	Use nsIDOMWindowInternal::Close to close tabs. Delay tabs destruction
	to an idle handler, to avoid crashes when tabs are closed from signal
	handlers (blur, mousedown, keydown etc).
	Fixes bug #172878, bug #172879, bug #172882, bug #303254, bug #313425.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* embed/print-dialog.c: (ephy_print_do_print_idle_cb):

	Remove unused variable.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* lib/widget/ephy-spinner.c:

	Remove unused code.

2005-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-debug.h:
	
	Don't include config.h here.

	* lib/widgets/ephy-spinner.c: (ephy_spinner_cache_data_unload),
	(ephy_spinner_cache_data_load), (ephy_spinner_cache_data_new),
	(ephy_spinner_cache_data_free), (ephy_spinner_cache_get_images),
	(ephy_spinner_cache_init), (ephy_spinner_cache_finalize),
	(ephy_spinner_load_images), (ephy_spinner_init),
	(bump_spinner_frame_cb), (ephy_spinner_start),
	(ephy_spinner_set_timeout), (ephy_spinner_finalize),
	(ephy_spinner_screen_changed), (ephy_spinner_class_init):
	
	Make spinner multihead safe.

	* lib/widgets/testspinner.c:
	
	Add a tiny spinner test program.

2005-10-01  Christian Persch  <chpe@cvs.gnome.org>

	* lib/widgets/ephy-spinner.c: (ephy_spinner_init),
	(ephy_spinner_start), (ephy_spinner_stop), (ephy_spinner_map),
	(ephy_spinner_unmap), (ephy_spinner_class_init):

	Don't spin unmapped spinners. Slightly decrease the frequency.
	Might help with bug #315232.

2005-10-01  Christian Persch  <chpe@cvs.gnome.org>

	* lib/widgets/ephy-location-entry.c: (entry_key_press_cb):

	Reset the IM context before activating the entry.

	* lib/widgets/ephy-node-view.c: (ephy_node_view_key_press_cb):
	* src/ephy-find-toolbar.c: (tab_search_key_press_cb):

	Add GDK_ISO_Enter to recognised keyvals.

2005-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyAboutModule.cpp:

	Return error on failure.

2005-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_file_bookmark_page):

	Don't free const strings.

2005-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-notebook.c: (sync_label):
	* src/ephy-tab.c: (ephy_tab_get_title_composite),
	(ephy_tab_get_title):
	* src/ephy-tab.h:
	* src/ephy-tabs-menu.c: (sync_tab_title):
	* src/ephy-window.c: (sync_tab_title):
	* src/window-commands.c: (window_cmd_file_send_to),
	(window_cmd_file_bookmark_page):

	Add a function to get the tab's real title, and use it
	where appropriate. Fixes bug #317418.

2005-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/FilePicker.cpp:

	Hide the filters combo if there's only the "All" filter.

2005-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* data/default-prefs-common.js:

	Back out the fix for bug #158486 by re-enabling keyword:
	searches. Fixes bug #314974.

2005-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-notebook.c: (tab_label_style_set_cb),
	(build_tab_label):

	Use the tab label's outer hbox for the size calculation instead
	of the label itself. Fixes size oscillations with the Tab States
	extension.

2005-09-26  Jean-François Rameau  <jframeau@cvs.gnome.org>

	* src/ephy-lockdown.c: (update_window):
	* src/ephy-window.c: (update_popups_tooltips), (show_embed_popup):
	* src/popup-commands.c:
	* src/popup-commands.h:
	* embed/mozilla/EventContext.cpp: (GetEventContext):
	* data/ui/epiphany-ui.xml:

	Unify background image and image code (contex menu, conext event). 
	Fix bug 154887.

2005-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/Makefile.am:
	* embed/mozilla/GtkNSSSecurityWarningDialogs.cpp: (DoDialog):

	Back out previous change, it doesn't work right when there
	are *two* dialogues shown: the 1st one can only be dismissed
	after the 2nd one has been dismissed.

2005-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/Makefile.am:
	* embed/mozilla/AutoEventQueue.cpp:
	* embed/mozilla/AutoEventQueue.h:
	* embed/mozilla/GtkNSSSecurityWarningDialogs.cpp: (DoDialog):
	
	Push a new event queue while showing the dialogue
	with gtk_dialog_run. This fixes the problem (caused by the
	braindead API of showing this dialogue synchronously) that
	networking is blocked in all other windows while the dialogue
	is shown.
	
2005-09-25  Jean-François Rameau  <jframeau@cvs.gnome.org>

	* data/epiphany-lockdown.schemas.in:

	Add disable_quit to lockdown gconf schema. Fix bug 316499.

2005-09-24  Crispin Flowerday  <gnome@flowerday.cx>

	* data/epiphany.m4:

	Rename the autoconf macro to EPIPHANY_EXTENSION_INIT() and make it
	check the ephy version, get the extension directory and find out
	whether python is enabled.

2005-09-24  Jean-François Rameau  <jframeau@cvs.gnome.org>

	* embed/mozilla/EphyAboutModule.cpp: (GetErrorMessage):

	Handle contentEncodingError error.

2005-09-24  Crispin Flowerday  <gnome@flowerday.cx>

	* lib/Makefile.am:
	* lib/ephy-module.c: (ephy_module_load):

	If the library path isn't absolute, look in the main extension
	dir, and then the users own extension directory

2005-09-23  Crispin Flowerday  <gnome@flowerday.cx>

	* src/ephy-extensions-manager.c:
	(ephy_extensions_manager_load_ini_string):

	Don't crash if the Authors key is missing, or
	there are no keys in the Loader section

2005-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-extensions-manager.c:

	s/DOT_INIT/DOT_INI/g.

2005-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* src/epphy-extensions-manager.c: (free_extension_info),
	(ephy_extensions_manager_load_xml_string), (path_to_identifier),
	(ephy_extensions_manager_load_file), (load_file_from_monitor),
	(dir_changed_cb), (ephy_extensions_manager_load_dir):

	Don't read unused variables, and use a #define for the
	keyfile extension.

2005-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-python-loader.c: (impl_get_object):

	Accept "Module" argument.

2005-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-shlib-loader.c: (impl_get_object)
	(ephy_shlib_loader_class_init):

	Support "Library" argument.

2005-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* data/Makefile.am:
	R data/epiphany-extension.xsd:
	* src/ephy-extensions-manager.c:
	(ephy_extensions_manager_load_xml_string),
	(ephy_extensions_manager_startup),
	(ephy_extensions_manager_finalize):

	Since the .xml format is deprecated, remove the (already #if 0'd)
	schema validation code.

2005-09-23  Crispin Flowerday  <gnome@flowerday.cx>

	* data/epiphany.m4: Really add the file

2005-09-23  Crispin Flowerday  <gnome@flowerday.cx>

	* data/Makefile.am:
	* data/epiphany.m4:
	* src/ephy-extensions-manager.c: (free_extension_info),
	(ephy_extensions_manager_load_xml_string),
	(ephy_extensions_manager_load_ini_string), (path_to_identifier),
	(ephy_extensions_manager_load_file), (load_extension),
	(load_file_from_monitor), (dir_changed_cb),
	(ephy_extensions_manager_load_dir):

	Add support for extension description files in the keyfile
	format, using the extension .ephy-extension. Also included
	is a m4 macro to help do the translation of these files.
	
2005-09-21  Jean-François Rameau  <jframeau@cvs.gnome.org>

	* embed/mozilla/mozilla-embed-single.cpp: (have_gnome_url_handler):

	Remove unused function.

2005-09-21  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-gui.c:

	Fix compile warnings.

2005-09-21  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyUtils.cpp:
	* embed/print-dialog.c: (ephy_print_do_print_idle_cb):

	Don't use "cat >" as output command, it fails inpredicably.
	Instead, use the tempfile setting, and set "PostScript/default"
	as printer name. fflush before printing the temp file
	using gnome-print. If not using gecko 1.9, translate the paper
	name to the one mozilla expects (mozilla bug 
	https://bugzilla.mozilla.org/show_bug.cgi?id=307404).

2005-09-21  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-gui.c: (ephy_gui_check_location_writable):
	* lib/ephy-gui.h:

	New function to check the filename/directory for writability,
	derived from the now removed ephy_gui_confirm_overwrite_file.
	
	* src/bookmarks/ephy-bookmarks-editor.c:
	* embed/mozilla/FilePicker.cpp:
	* embed/mozilla/ContentHandler.cpp:
	* embed/mozilla/EphyHeaderSniffer.cpp:

	Use the filechooser's stock confirm-overwrite checking, but
	we still need our own writability check.

2005-09-19  Christian Persch  <chpe@cvs.gnome.org>

	* embed/ephy-embed.h:
	* embed/mozilla/mozilla-embed.cpp:

	Add EPHY_EMBED_STATE_RESTORING and conversion from
	GTK_MOZ_EMBED_FLAG_RESTORING.

2005-09-19  Christian Persch  <chpe@cvs.gnome.org>

	* data/mime-types-permissions.xml:

	Add another mime alias.

2005-09-19  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (_ephy_window_set_context_event),
	(_ephy_window_unset_context_event), (embed_popup_deactivate_cb),
	(show_embed_popup), (ephy_window_dispose):
	* src/ephy-window.h:

	Make the methods to unset/release the context event semi-public.

2005-09-16  Raphael Slinckx  <rslinckx@cvs.gnome.org>

	* src/bookmarks/ephy-bookmark-action.c:
	(bookmark_activate_with_flags), (open_in_tab_activate_cb),
	(open_in_window_activate_cb), (activate_cb):
	* src/bookmarks/ephy-bookmarks.c: (impl_resolve_address):
	Repair the previous b0rkage, see previous log

2005-09-15  Raphael Slinckx  <rslinckx@cvs.gnome.org>

	* src/bookmarks/ephy-bookmarks.c: (impl_resolve_address):
	If the search term is empty for a smart bookmark use the normal
	URL instead of the smart url with the %s replaced by ""

2005-09-15  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/GtkNSSDialog.cpp:

	Don't focus the checkbox initially. Fixes bug #163371.

2005-09-15  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-toolbar-editor.c: (ephy_toolbar_editor_construct):

	Make Close the default button.

2005-09-14  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Set "website-label" property.

2005-09-09  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphySingle.cpp:

	Manually emit the "profile-change-net-teardown" notification;
	works around bug https://bugzilla.mozilla.org/show_bug.cgi?id=292699.

2005-09-07  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyUtils.cpp:

	Remove unused code.

2005-09-05  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/GlobalHistory.cpp:
	* embed/ephy-history.h:

	Implement [SG]etGeckoURIFlags for gecko 1.9.

2005-09-05  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyUtils.cpp:

	Mozilla printing code is braindead. Bug #163255.

2005-09-03  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:

	Depend on pygtk 2.8. Fixes bug #314557.

	* src/languages.h:

	Remove duplicate entries.

2005-09-01  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-toolbar-editor.c: (ephy_toolbar_editor_constructor):
	* src/pdm-dialog.c: (show_cookies_properties):

	Fix HIG spacings.

2005-09-01  Christian Persch  <chpe@cvs.gnome.org>

	* data/glade/epiphany.glade:

	Remove find dialogue, and tweak spacings to be HIG compliant.

2005-09-01  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/EphyBrowser.cpp:

	Only listen for trusted events.

2005-08-31  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:

	Update gtk requirement.

2005-08-31  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/GtkNSSSecurityWarningDialogs.cpp:

	Better message on the enter-secure warning.

2005-08-29  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-debug.c:

	Only include execinfo.h if it exists.

2005-08-29  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* lib/ephy-debug.c: (trap_handler):

	Check for execinfo.h. Fixes bug #314776.

2005-08-28  Christian Persch  <chpe@cvs.gnome.org>

	* ChangeLog-20050828:
	* Makefile.am:
	* autogen.sh:
	* configure.ac:
	* data/Makefile.am:
	* data/epiphany-1.10.pc.in:
	* data/epiphany-1.8.pc.in:
	* doc/reference/Makefile.am:
	* embed/Makefile.am:
	* embed/mozilla/Makefile.am:
	* lib/Makefile.am:
	* lib/egg/Makefile.am:
	* lib/ephy-dbus.c: (session_filter_func), (system_filter_func),
	(ephy_dbus_connect_to_session_bus), (ephy_dbus_disconnect_bus):
	* lib/widgets/Makefile.am:
	* src/Makefile.am:
	* src/bookmarks/Makefile.am:

	Version 1.9.
