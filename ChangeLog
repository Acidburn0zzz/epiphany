2004-10-10  Marco Pesenti Gritti  <marco@gnome.org>

	reviewed by: Christian Persch  <chpe@cvs.gnome.org>

	* data/glade/print.glade:
	* embed/ephy-embed-single.c: (ephy_embed_single_get_printer_list):
	* embed/ephy-embed-single.h:
	* embed/mozilla/ContentHandler.cpp:
	* embed/mozilla/EphyBrowser.cpp:
	* embed/mozilla/EphyHeaderSniffer.cpp:
	* embed/mozilla/EphyUtils.cpp:
	* embed/mozilla/EphyUtils.h:
	* embed/mozilla/FilePicker.cpp:
	* embed/mozilla/GtkNSSClientAuthDialogs.cpp:
	* embed/mozilla/GtkNSSDialogs.cpp:
	* embed/mozilla/GtkNSSKeyPairDialogs.cpp:
	* embed/mozilla/MozillaPrivate.cpp:
	* embed/mozilla/MozillaPrivate.h:
	* embed/mozilla/PrintingPromptService.cpp:
	* embed/mozilla/mozilla-embed-single.cpp:
	* embed/mozilla/mozilla-embed.cpp:
	* embed/print-dialog.c: (ephy_print_dialog_new):
	* lib/ephy-dialog.c: (set_combo_box_from_value):

	Move current MozillaPrivate helpers to EphyUtils.
	Use MozillaPrivate for stuff that needs mozilla
	internal strings.

	Support multiple printers in the print dialog.
	This is actually a bug fix because on several
	distributions using hardcoded Poscript/default
	will simply not work at all.

2004-10-10  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* src/Makefile.am:

	Remove duplicate AM_PROG_INTLTOOL, fixes bug #155028.
	Use AM_GLIB_DEFINE_LOCALEDIR to define locale dir.

2004-10-08  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-tab.c:
	* src/ephy-tab.h:
	* src/ephy-window.c:
	* src/ephy-window.h:

	No circular dependencies anymore.

2004-10-08  Christian Persch  <chpe@cvs.gnome.org>

	* src/bookmarks/ephy-bookmarks-menu.c: (bookmark_added_cb):

	When adding a bookmark, check if it has same node ID as one
	scheduled for removal, and if so, process the removal immediately.
	Fixes bug #154805.

2004-10-08  Marco Pesenti Gritti  <marco@gnome.org>

	reviewed by: Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (get_name_from_address_value),
	(update_popups_tooltips), (show_embed_popup):

	Add tooltips for context menus. Fix #151764

2004-10-08  Marco Pesenti Gritti  <marco@gnome.org>

	reviewed by: Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-dialog.c: (setup_default_size):
	* lib/ephy-state.c: (create_window_node), (ephy_state_add_window):
	* lib/ephy-state.h:
	* src/bookmarks/ephy-bookmark-properties.c: (build_ui):
	* src/bookmarks/ephy-bookmarks-editor.c:
	(ephy_bookmarks_editor_construct):
	* src/bookmarks/ephy-new-bookmark.c: (ephy_new_bookmark_construct):
	* src/ephy-history-window.c: (ephy_history_window_construct):
	* src/ephy-window.c: (ephy_window_show):
	* src/pdm-dialog.c: (show_cookies_properties):
	* src/window-commands.c: (window_cmd_edit_toolbar):

	Allow to set the default window state to maximize.
	Default to maximize for the browser window.

2004-10-07  Marco Pesenti Gritti  <marco@gnome.org>

	reviewed by: Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/Makefile.am:
	* embed/mozilla/mozilla-embed-single.cpp:

	Initialize plugins path env var for backward compatibility

2004-10-06  Christian Persch  <chpe@cvs.gnome.org>

	* embed/ephy-embed.h:

	Remove unnecessary include.

2004-10-06  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (ephy_window_set_property),
	(ephy_window_get_property), (ephy_window_class_init),
	(ephy_window_set_print_preview):

	Notify when entering or leaving print preview mode. Fixes bug #154591.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* data/epiphany.schemas.in:

	Grammar fix. Fixes bug #154605.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-navigation-action.c: (build_back_or_forward_menu),
	(build_up_menu), (menu_activated_cb):

	Fix a warning, noticed by Crispin.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (ephy_window_key_press_event):

	Don't allow activation of the hidden menubar in ppv mode.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-window.c: (get_chromes_visibility),
	(ephy_window_fullscreen), (ephy_window_unfullscreen),
	(ephy_window_delete_event_cb), (show_embed_popup),
	(ephy_window_init), (ephy_window_set_print_preview):

	Fix print preview and fullscreen mode interaction. Fixes bug #154456.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-tab.c: (ephy_tab_size_allocate), (ephy_tab_map),
	(ephy_tab_class_init):

	Don't size-allocate unmapped tabs, fixing slow resizes.
	Fixes bug #128191.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* lib/egg/Makefile.am:
	R lib/egg/eggdropdowntoolbutton.c:
	R lib/egg/eggdropdowntoolbutton.h:
	* src/ephy-navigation-action.c: (menu_activated_cb),
	(connect_proxy), (ephy_navigation_action_class_init):

	Port to GtkMenuToolButton.

2004-10-05  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/GtkNSSClientAuthDialogs.cpp:
	* embed/mozilla/GtkNSSDialogs.cpp:
	* embed/mozilla/GtkNSSKeyPairDialogs.cpp:

	Set window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-gui.c: (ephy_gui_menu_position_tree_selection),
	(ephy_gui_confirm_overwrite_file):
	* src/ephy-window.c: (confirm_close_with_modified_forms),
	(ephy_window_init):

	Set window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* src/bookmarks/ephy-bookmark-properties.c: (set_window_icon),
	(ephy_bookmark_properties_get_node):
	* src/bookmarks/ephy-bookmarks-editor.c:
	(ephy_bookmarks_editor_construct):
	* src/bookmarks/ephy-new-bookmark.c: (ephy_new_bookmark_construct),
	(duplicate_dialog_construct):
	* src/ephy-history-window.c: (ephy_history_window_construct):
	* src/window-commands.c: (window_cmd_edit_toolbar):

	Set window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-file-chooser.c: (ephy_file_chooser_constructor):

	Set ephy icon as window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* src/pdm-dialog.c: (pdm_dialog_init):

	Set ephy icon as window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* src/prefs-dialog.c: (prefs_dialog_init):

	Same here.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* embed/find-dialog.c: (find_dialog_init):

	Same here.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* embed/print-dialog.c: (ephy_print_dialog_new),
	(ephy_print_setup_dialog_new):

	Set window icon with gtk_window_set_icon_name().

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* embed/downloader-view.c: (downloader_view_build_ui):

	Set the window icon.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* embed/downloader-view.c: (downloader_view_add_download):

	Arg 4 of gtk_icon_theme_lookup_icon is flags, not height.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Set epiphany icon on the about dialogue.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* src/ppview-toolbar.c: (ppview_toolbar_get_type),
	(ppview_toolbar_class_init), (ppview_toolbar_set_property),
	(ppview_toolbar_get_property), (ppview_toolbar_set_window),
	(ppview_toolbar_init), (ppview_toolbar_finalize),
	(ppview_toolbar_new), (toolbar_cmd_ppv_close):
	* src/ppview-toolbar.h:

	Clean up a bit.

2004-10-04  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/mozilla-embed-single.cpp:

	Fix a warning.

2004-10-03  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Remove unused variable.

2004-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/MozDownload.cpp:
	* lib/ephy-file-helpers.c: (ephy_file_downloads_dir),
	(ephy_file_desktop_dir):
	* lib/ephy-file-helpers.h:
	* src/prefs-dialog.c: (get_download_button_label):

	Recognise "Desktop" special downloads directory. Fixes bug #152926.

2004-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* Makefile.am:

	Add --with-mozilla to distcheck's configure arguments. 

2004-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Simply use gtk_icon_theme_load_icon().

2004-10-02  Christian Persch  <chpe@cvs.gnome.org>

	* src/ephy-main.c: (main):
	* src/ephy-window.c: (ephy_window_init):

	Use gtk_window_set_default_icon_name().

2004-09-30  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/mozilla-notifiers.cpp:

	Remove explicit PAC autoconf call, it works perfectly ok without it.

2004-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-debug.c: (trap_handler):

	Remove "abort", since you can have the same with --g-fatal-warnings.

2004-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* doc/debugging.txt:

	Document EPHY_DEBUG_BREAK.

2004-09-28  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* data/Makefile.am:
	A data/default-prefs-common.js:
	A data/default-prefs-mozilla.js:
	A data/default-prefs-toolkit.js:
	R data/default-prefs.js:

	Split the default prefs into the common part, and mozilla/new toolkit
	specific parts.

2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* lib/egg/Makefile.am:
	* src/bookmarks/ephy-bookmark-action.c: (remove_from_model),
	(move_in_model):
	* src/bookmarks/ephy-bookmarks.c:
	(ephy_bookmarks_get_toolbars_model):
	* src/bookmarks/ephy-bookmarks.h:
	* src/bookmarks/ephy-bookmarksbar.c:
	(ephy_bookmarksbar_set_property):
	* src/bookmarks/ephy-topic-action.c: (remove_from_model),
	(move_in_model):
	* src/ephy-shell.c: (ephy_shell_get_toolbars_model):

	Don't reference private objects from public headers. Fixes bug #153766.

2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* lib/ephy-debug.c: (trap_handler), (ephy_debug_init):

	Remove the hack, and just use the libc function for it.
	Thanks to Crispin for suggesting this.
	
2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:

	Improve configure check for DumpStackToFile to actually work.

2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* lib/ephy-debug.c: (trap_handler), (ephy_debug_init):

	Improved debugging support. Fixes bug #153805.

2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* data/ui/epiphany-ui.xml:

	Install a placeholder for the view toggles group. Fixes bug #153767.

2004-09-27  Christian Persch  <chpe@cvs.gnome.org>

	* lib/Makefile.am:

	Make ephy-state.h public. Fixes bug #153809.

2004-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyBrowser.cpp:
	* embed/mozilla/EventContext.cpp:
	* embed/mozilla/GtkNSSDialogs.cpp:
	* embed/mozilla/mozilla-notifiers.cpp:
	* lib/egg/eggtrayicon.h:

	Fix compiler warnings.

	* src/ephy-window.c: (hide_embed_popup_cb), (show_embed_popup):

	Fix a signal leak.

2004-09-26  Christian Persch  <chpe@cvs.gnome.org>

	* src/popup-commands.c: (popup_cmd_bookmark_link),
	(popup_cmd_copy_image_location):

	Remove some unused code. Patch by Crispin Flowerday.

2004-09-27  Marco Pesenti Gritti  <marco@gnome.org>

	* lib/egg/Makefile.am:

	Install egg-toolbars-model.h

2004-09-25  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:

	Remove another unnecessary define.

2004-09-25  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:

	Remove an unnecessary define.

2004-09-25  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/GlobalHistory.cpp:
	* embed/mozilla/mozilla-embed-single.cpp:

	Mozilla API changes.

2004-09-23  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/mozilla-embed-single.cpp:

	Remove reference to MOZILLA_FIVE_HOME.

2004-09-22  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Fix a mem leak.

2004-09-22  Christian Persch  <chpe@cvs.gnome.org>

	* src/bookmarks/ephy-topic-action.c: (drag_motion_cb):

	Fix a mem leak.

2004-09-22  Christian Persch  <chpe@cvs.gnome.org>

	* lib/ephy-dialog.c: (set_editable_from_value):

	Initialise position passed to gtk_editable_insert_text().

2004-09-22  Christian Persch  <chpe@cvs.gnome.org>

	* embed/ephy-download.c: (update_remaining_time):

	Fix the build.

2004-09-21  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/EphyContentPolicy.cpp:

	Simplified nsIContentPolicy API check.

2004-09-21  Christian Persch  <chpe@cvs.gnome.org>

	* configure.ac:
	* embed/mozilla/ContentHandler.cpp:
	* embed/mozilla/ContentHandler.h:
	* embed/mozilla/EphyBrowser.cpp:
	* embed/mozilla/EphyBrowser.h:
	* embed/mozilla/EphyContentPolicy.cpp:
	* embed/mozilla/FilePicker.cpp:
	* embed/mozilla/GlobalHistory.cpp:
	* embed/mozilla/GtkNSSKeyPairDialogs.cpp:
	* embed/mozilla/Makefile.am:
	* embed/mozilla/MozDownload.cpp:
	* embed/mozilla/mozilla-download.cpp:
	* embed/mozilla/mozilla-embed-single.cpp:
	* embed/mozilla/mozilla-embed.cpp:
	* embed/mozilla/mozilla-notifiers.cpp:

	Fix mozilla API checks to correctly detect firefox libraries.

2004-09-21  Marco Pesenti Gritti  <marco@gnome.org>

	* embed/ephy-download.c: (update_remaining_time):

	Fix overflow in remaining time calculation. Fix bug
	#153136. Thanks to Jhon Spray for tracking this.

2004-09-18  Christian Persch  <chpe@cvs.gnome.org>

	* embed/downloader-view.c: (progress_cell_data_func):
	* embed/mozilla/MozDownload.cpp:

	Fix download progress indicator in downloader view.

2004-09-18  Marco Pesenti Gritti  <marco@gnome.org>

	reviewed by: Christian Persch  <chpe@cvs.gnome.org>

	* embed/ephy-embed-persist.h:
	* embed/ephy-favicon-cache.c: (ephy_favicon_cache_download):
	* embed/mozilla/MozDownload.cpp:

	Enable conversion for favicon downloads. Fix #152866.

2004-09-16  Marco Pesenti Gritti  <marco@gnome.org>

	* src/ephy-window.c: (ephy_window_focus_in_event),
	(ephy_window_focus_out_event), (ephy_window_class_init):

	Show the fullscreen button only when the window is active.
	Fix #115296.

2004-09-16  Marco Pesenti Gritti  <marco@gnome.org>

	* src/ephy-window.c: (update_fullscreen_popup),
	(screen_size_changed_cb), (fullscreen_popup_size_request_cb),
	(ephy_window_fullscreen):

	Keep popup position synced with his size requisition.
	Fix #143585

2004-09-16  Christian Persch  <chpe@cvs.gnome.org>

	* src/window-commands.c: (window_cmd_help_about):

	Port to GtkAboutDialog.

2004-09-15  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/mozilla-embed.cpp:

	More fix for mozilla 1.7.3 API-non-change.

2004-09-15  Christian Persch  <chpe@cvs.gnome.org>

	* embed/mozilla/EphyBrowser.cpp:
	* embed/mozilla/EphyBrowser.h:
	* embed/mozilla/GlobalHistory.cpp:

	Fix for mozilla 1.7.3 API-non-change.

2004-09-15  Marco Pesenti Gritti  <marco@gnome.org>

	* lib/widgets/ephy-node-view.c: (ephy_node_view_add_toggle),
	(ephy_node_view_popup):
	* lib/widgets/ephy-node-view.h:

	Add api to show a context menu. Useful to make distinction
	between key and mouse events.

	* src/bookmarks/ephy-bookmarks-editor.c:
	(ephy_bookmarks_editor_show_popup_cb),
	(keyword_node_show_popup_cb):
	* src/ephy-history-window.c: (ephy_history_window_show_popup_cb):

	Use it. Fix #152431

2004-09-13  Marco Pesenti Gritti  <marco@gnome.org>

	* lib/ephy-guy.c:
	* src/bookmarks/ephy-bookmarks-editor.c:
	* src/ephy-history-window.c:

	Better positioning of context menus for treeviews.
	Fix #152431

2004-09-13  Adam Hooper  <adamh@cvs.gnome.org>

	* data/Makefile.am:
	* data/epiphany-extension.xsd:

	Added (proposed) XML schema for Extension metadata files (work in
	progress).

2004-09-13  Adam Hooper  <adamh@cvs.gnome.org>

	* data/epiphany.schemas.in:
	* doc/reference/Makefile.am:
	* doc/reference/epiphany-docs.sgml:
	* doc/reference/epiphany-sections.txt:
	* doc/reference/epiphany.types:
	* doc/reference/tmpl/ephy-embed-factory.sgml:
	* doc/reference/tmpl/ephy-embed.sgml:
	* doc/reference/tmpl/ephy-extensions-manager.sgml:
	* doc/reference/tmpl/ephy-shell.sgml:
	* doc/reference/tmpl/ephy-window.sgml:
	* doc/reference/tmpl/epiphany-unused.sgml:
	* lib/ephy-module-loader.c: (ephy_module_loader_new),
	(ephy_module_loader_load), (ephy_module_loader_unload),
	(ephy_module_loader_get_path):
	* lib/ephy-module-loader.h:
	* src/ephy-extensions-manager.c: (free_ext_info),
	(windows_foreach), (attach_window), (detach_window),
	(instantiate_extension), (real_load),
	(ephy_extensions_manager_load), (real_unload),
	(ephy_extensions_manager_unload), (ephy_extensions_manager_add),
	(sync_one_extension), (ephy_extensions_manager_sync_gconf),
	(ephy_extensions_manager_load_file),
	(ephy_extensions_manager_load_dir), (active_extensions_notifier),
	(ephy_extensions_manager_init), (ephy_extensions_manager_finalize),
	(attach_window_to_info), (impl_attach_window),
	(detach_window_from_info), (impl_detach_window):
	* src/ephy-extensions-manager.h:
	* src/ephy-shell.c: (ephy_shell_get_extensions_manager):

	Load/unload extensions based on GConf key
	/apps/epiphany/general/active_extensions.

	Update documentation a bit (i.e., make sure it actually builds).

2004-09-13  Christian Persch  <chpe@cvs.gnome.org>

	* data/art/epiphany-entry.png:
	* src/bookmarks/ephy-bookmarks-menu.c:
	(ephy_bookmarks_menu_set_window):
	* src/bookmarks/ephy-bookmarksbar.c:
	(ephy_bookmarksbar_set_window):
	* src/bookmarks/ephy-favorites-menu.c: (ephy_favorites_menu_clean),
	(ephy_favorites_menu_rebuild):
	* src/ephy-encoding-menu.c: (ephy_encoding_menu_set_window):
	* src/ephy-tabs-menu.c: (ephy_tabs_menu_set_window),
	(ephy_tabs_menu_clean), (ephy_tabs_menu_update):
	* src/ephy-window.c: (add_widget), (sync_chromes_visibility),
	(ephy_window_key_press_event), (init_menu_updaters),
	(setup_ui_manager), (show_embed_popup), (ephy_window_init),
	(ephy_window_finalize), (ephy_window_set_print_preview),
	(ephy_window_get_ui_manager):
	* src/ephy-window.h:
	* src/ppview-toolbar.c: (ppview_toolbar_set_window):
	* src/toolbar.c: (toolbar_set_window), (toolbar_new):
	* src/window-commands.c: (window_cmd_edit_toolbar):

	Add ephy_window_get_ui_manager(), and remove the manager
	from the public EphyWindow struct.

2004-09-13  Christian Persch  <chpe@cvs.gnome.org>

	* Makefile.am:

	Add ChangeLog-20040912 to EXTRA_DIST.

2004-09-13  Christian Persch  <chpe@cvs.gnome.org>

	Merging pre-gnome-2-10 branch to HEAD.

	Splitting ChangeLog.

